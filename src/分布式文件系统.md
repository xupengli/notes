##分布式文件系统
***
分布式文件系统顾名思义就是分布式＋文件系统。
文件系统提供了一系列的API来进行文件的增删改查，分布式的系统不在和普通的文件系统一样负责管理本地的磁盘，它的文件目录和内容都不是存储在本地磁盘上。而是通过网络存储在远端系统上，并且是一簇机器协同提供服务。

>***术语对照***

 文中所用翻译|HDFS中的术语|GFS中的术语|术语解释
----|----|---|---
主控服务器|NameNode|Master|整个文件系统的大脑，提供整个文件系统的目录，并且管理各个数据服务器
数据服务器|DateNode|Chunk Server|分布式文件系统的每个文件都被切割成若干个数据块，每个数据快都存储在不同的服务器上，此服务器称之为数据服务器
数据块|Block|Chunk|每个文件都会切分成若干块，每一个数据块都有一段连续的文件内容是数据存储的最小单位
数据包|Packet|无|客户端写文件的时候不是一个字节一个字节写入文件系统的，而是累计到一定数量后写一次，每发送一次的数据称之为数据包
传输块|chunk|无|在每个数据包中，都会讲数据块切成更小的块，每个块配上一个奇偶校验码，这样的块就是传输块
备份主控服务器|SecondaryNameNode|无|备用的主控服务器，拉取主控服务器的日志，等待备用

>服务器介绍

重要的服务器包括：主控服务器、数据服务器、客户服务器。

数据服务器中每个文件的具体数据被分割成若干数据块，冗余的存放在数据服务器上，通常的每个配置是64M（***经过实践所得，太大容易造成热点的堆叠，大量的数据操作集中在一台数据服务器上，太小附加的控制传输成本太高***），在三个数据服务器上冗余存放。

客户端在一个独立的进程中提供服务，作为一个类库为用户提供增删改查的APIS。

>数据分布

每一个文件数据块，在数据服务器上都表征为一对文件（普通的linux文件），一个是数据文件，一个是附加信息的源文件，我们把这对文件称之为数据块文件。数据块文件存放在数据目录下，它有一个名为current的根目录，然后里面有若干个数据块文件和dir0-dir63的最多64个子目录，子目录结构等同于current目录。

主控服务器主要有三类数据：文件系统的目录结构、各个文件的分块信息、数据块的物理位置
在GFS和HDFS的架构中，只有文件的目录结构和分块信息才会被持久化到本地磁盘上，而数据块位置信息则是动态汇总过来的，仅仅存放在内存数据结构中。每一个数据服务器启动后，都会向主控服务器发送注册信息，将其上的数据块的状况通知到主控服务器。

在HDFS中，FSNamespacesystem类就负责保管文件系统的目录结构以及每个文件的分块状况的，其中，前者是由FSDirectory类来负责，后者是各个INodeFile本身维护。在INodeFile里面，有一个BlockInfo的数组，保存着与该文件相关的所有数据块信息，BlockInfo中包含了从数据块到数据服务器的映射，INodeFile只需要知道一个偏移量，就可以提供相关的数据块，和数据块存放的数据服务器信息






